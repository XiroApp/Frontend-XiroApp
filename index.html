<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <title>XIRO APP - Tu mejor compañero</title>

    <!-- Meta descripción para SEO -->
    <meta
      name="description"
      content="Accede de manera rápida y sencilla a materiales de estudio impresos y artículos de librería"
    />

    <!-- Open Graph para redes sociales -->
    <meta property="og:url" content="https://xiroapp.com.ar" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="XIRO APP" />
    <meta
      property="og:description"
      content="Accede de manera rápida y sencilla a materiales de estudio impresos y artículos de librería"
    />
    <meta
      property="og:image"
      content="https://opengraph.b-cdn.net/production/images/04d5ded6-860b-44da-a974-eb6c95d13848.png"
    />

    <!-- Twitter Card básica -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://xiroapp.com.ar" />

    <!-- Control de cache para HTML -->
    <meta
      http-equiv="Cache-Control"
      content="no-cache, no-store, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <script>
      const APP_VERSION = __APP_VERSION__;

      (async function cleanupIfNeeded() {
        const storedVersion = localStorage.getItem("app-version");
        if (storedVersion !== APP_VERSION) {
          localStorage.clear();
          sessionStorage.clear();
          document.cookie.split(";").forEach((cookie) => {
            document.cookie = cookie
              .replace(/^ +/, "")
              .replace(
                /=.*/,
                "=;expires=" + new Date().toUTCString() + ";path=/"
              );
          });

          if (window.indexedDB?.databases) {
            const dbs = await indexedDB.databases();
            dbs.forEach((db) => indexedDB.deleteDatabase(db.name));
          }

          if ("serviceWorker" in navigator) {
            const regs = await navigator.serviceWorker.getRegistrations();
            regs.forEach((reg) => reg.unregister());
          }

          if ("caches" in window) {
            const names = await caches.keys();
            names.forEach((name) => caches.delete(name));
          }

          localStorage.setItem("app-version", APP_VERSION);
          location.reload(true); // Forzar recarga limpia
        }
      })();
    </script>
  </head>

  <body>
    <div id="root"></div>

    <!-- Scripts principales -->
    <script type="module" src="/src/main.jsx" crossorigin="anonymous"></script>
    <script src="https://acrobatservices.adobe.com/view-sdk/viewer.js"></script>
  </body>
</html>
